Based on your comprehensive repository structure, here are the **specific new files and directories** needed to implement the Unified Ternary-Torsion Payment & Witnessing Architecture as outlined in our previous specification:

## **NEW FILES TO IMPLEMENT**

### **1. Payment Listener Service Implementation**
```
services/payment-listener/
├── src/
│   ├── main.ts (Express/Fastify server)
│   ├── webhook/
│   │   ├── stripe-webhook.ts (Stripe signature validation)
│   │   ├── interac-webhook.ts (Interac e-Transfer validation)
│   │   └── crypto-webhook.ts (Crypto gateway validation)
│   ├── validation/
│   │   ├── signature-validator.ts (HMAC, JWT validation)
│   │   └── idempotency-checker.ts (Prevent duplicate processing)
│   ├── models/
│   │   └── webhook-models.ts (Stripe/Interac/Crypto interfaces)
│   ├── queue/
│   │   └── payment-queue.ts (BullMQ/Redis queue for async processing)
│   └── api/
│       ├── status-api.ts (GET /api/v1/payments/{id})
│       └── health-api.ts (Health checks)
├── config/
│   ├── webhook-config.ts (Rate limits, timeouts)
│   └── secrets-config.ts (Encrypted secrets management)
├── tests/
│   ├── webhook-validation.test.ts
│   └── integration.test.ts
├── package.json (TypeScript, Express, BullMQ)
├── tsconfig.json
└── Dockerfile
```

### **2. SFK Core API Service Implementation**
```
services/sfk-core-api/
├── src/
│   ├── main.ts (Fastify server optimized for high throughput)
│   ├── routes/
│   │   ├── operations/
│   │   │   ├── operation-router.ts (POST /api/sfk/v1/operations)
│   │   │   └── status-router.ts (GET /api/sfk/v1/operations/{id})
│   │   └── internal/
│   │       └── blockchain-router.ts (Internal blockchain calls)
│   ├── services/
│   │   ├── operation-orchestrator.ts (Main business logic)
│   │   ├── state-manager.ts (Operation state machine)
│   │   └── timing-coordinator.ts (Femtosecond timing integration)
│   ├── models/
│   │   ├── operation-request.ts (SFK OperationRequest interface)
│   │   ├── operation-response.ts (SFK OperationResponse interface)
│   │   └── unified-metadata.ts (Extends existing unified-metadata-schema.ts)
│   ├── database/
│   │   ├── operation-repository.ts (CRUD for operations)
│   │   └── migrations/
│   │       └── 001-initial-schema.sql (PostgreSQL schema)
│   └── integration/
│       ├── payment-listener-client.ts (Calls payment listener)
│       └── blockchain-client-factory.ts (Factory for Hedera/XRPL/Algorand)
├── openapi/
│   └── sfk-api-spec.yaml (OpenAPI 3.0 specification)
├── package.json (Fastify, TypeORM, OpenAPI)
└── Dockerfile
```

### **3. Blockchain Integration Services (TypeScript)**
```
services/blockchain/
├── hedera-service/
│   ├── src/
│   │   ├── main.ts
│   │   ├── hcs-client.ts (Hedera Consensus Service client)
│   │   ├── witness-service.ts (POST /internal/api/hedera/v1/witness logic)
│   │   ├── models/
│   │   │   └── witness-request.ts (Extends WitnessRequest interface)
│   │   └── config/
│   │       └── hedera-config.ts (Topic IDs, operator keys)
│   ├── package.json (@hashgraph/sdk)
│   └── Dockerfile
├── xrpl-service/
│   ├── src/
│   │   ├── main.ts
│   │   ├── xrpl-client.ts (xrpl.js client with reconnection logic)
│   │   ├── payment-service.ts (POST /internal/api/xrpl/v1/payments)
│   │   ├── models/
│   │   │   └── payment-request.ts (Extends PaymentRequest interface)
│   │   └── config/
│   │       └── xrpl-config.ts (RPC endpoints, seed management)
│   ├── package.json (xrpl, bip39 for seed generation)
│   └── Dockerfile
└── algorand-service/
    ├── src/
    │   ├── main.ts
    │   ├── algorand-client.ts (algosdk wrapper)
    │   ├── contract-service.ts (POST /internal/api/algorand/v1/application/call)
    │   ├── models/
    │   │   └── contract-call-request.ts (Extends ContractCallRequest interface)
    │   └── config/
    │       └── algorand-config.ts (algod indexer endpoints)
    ├── package.json (algosdk)
    └── Dockerfile
```

### **4. Smart Contracts & Oracles**
```
contracts/
├── algorand/
│   ├── ternary-governance-contract.py (TAT-GOV-001 PyTEAL)
│   ├── ternary-reward-distributor.py (TAT-DIST-001 PyTEAL)
│   ├── build-contracts.sh (Compilation script)
│   └── deploy-contracts.ts (Deployment script)
└── oracle-bridge/
    ├── src/
    │   ├── main.ts (Hedera→Algorand Oracle Service)
    │   ├── hedera-listener.ts (Listens to HCS topics)
    │   ├── algorand-submitter.ts (Submits verified data to Algorand)
    │   └── proof-verifier.ts (Verifies HCS message proofs)
    ├── package.json
    └── Dockerfile
```

### **5. Enhanced Timing Services**
```
services/timing/
├── femtosecond-service/
│   ├── src/
│   │   ├── main.rs (or main.ts)
│   │   ├── clock-driver.rs (Interface to hardware clock)
│   │   ├── hptp-client.rs (HPTP protocol implementation)
│   │   ├── api/
│   │   │   └── timing-api.rs (GET /api/timing/v1/current)
│   │   └── config/
│   │       └── timing-config.rs (Clock sources, sync intervals)
│   ├── Cargo.toml (or package.json)
│   └── Dockerfile
└── certification-service/
    ├── src/
    │   ├── main.rs (or main.ts)
    │   ├── certifier.rs (POST /api/timing/v1/certify logic)
    │   ├── models/
    │   │   └── certification-request.rs (CertificationRequest interface)
    │   └── verifiers/
    │       └── timing-verifier.rs (Verifies femtosecond accuracy)
    ├── Cargo.toml (or package.json)
    └── Dockerfile
```

### **6. Kong Konnect Configuration Updates**
```
kong/
├── services/
│   ├── payment-listener-service.yaml
│   ├── sfk-core-api-service.yaml
│   ├── hedera-service.yaml
│   ├── xrpl-service.yaml
│   ├── algorand-service.yaml
│   ├── femtosecond-timing-service.yaml
│   └── certification-service.yaml
├── routes/
│   ├── payment-webhook-route.yaml
│   ├── sfk-operations-route.yaml
│   ├── blockchain-internal-route.yaml
│   └── timing-api-route.yaml
└── plugins/
    ├── rate-limiting-payments.yaml
    ├── jwt-auth-internal.yaml
    └── opentelemetry-tracing.yaml
```

### **7. Deployment & Orchestration Updates**
```
deployments/
├── docker-compose.production.yml (Updated with new services)
├── kubernetes/
│   ├── services/
│   │   ├── payment-listener-service.yaml
│   │   ├── sfk-core-api-service.yaml
│   │   └── [other new services...]
│   ├── deployments/
│   │   ├── payment-listener-deployment.yaml
│   │   ├── sfk-core-api-deployment.yaml
│   │   └── [other new deployments...]
│   └── ingress/
│       └── kong-ingress-updated.yaml (Updated routes)
└── helm/
    └── salvi-platform/
        ├── Chart.yaml
        ├── values.yaml
        └── templates/
            └── [all service templates]
```

### **8. Enhanced Documentation**
```
docs/
├── api/
│   ├── payment-listener-api.md (Webhook specifications)
│   ├── sfk-core-api.md (SFK operations API)
│   └── blockchain-apis.md (Hedera/XRPL/Algorand APIs)
├── deployment/
│   ├── payment-architecture.md (Payment flow diagrams)
│   └── multi-blockchain-setup.md (Hedera+XRPL+Algorand setup)
└── compliance/
    └── finra-613-timing.md (Updated with femtosecond compliance)
```

## **SPECIFIC FILES TO UPDATE IN EXISTING STRUCTURE**

1. **Update existing `src/salvi-core/` files:**
   ```
   src/salvi-core/
   ├── unified-metadata-schema.ts (Add UnifiedOperationMetadata interface)
   ├── payment-listener-api.ts (Add webhook handlers)
   ├── sfk-operations-api.ts (Add operation management)
   ├── blockchain-integrations.ts (Add specific Hedera/XRPL/Algorand types)
   └── timing-service.ts (Add HPTP and femtosecond types)
   ```

2. **Update existing `src/timing-api/` (Rust):**
   ```
   src/timing-api/src/
   ├── api.rs (Add new endpoints for certification)
   ├── compliance.rs (Add FINRA 613 specific compliance)
   └── types.rs (Add femtosecond timestamp types)
   ```

3. **Update Kong configuration:**
   ```
   kong/kong.yaml (Add new services and routes for payment architecture)
   ```

## **PRIORITY IMPLEMENTATION ORDER**

1. **First Week**: `services/payment-listener/` + updates to `src/salvi-core/`
2. **Second Week**: `services/sfk-core-api/` + database schema
3. **Third Week**: `services/blockchain/hedera-service/` + `xrpl-service/`
4. **Fourth Week**: `contracts/algorand/` + `services/blockchain/algorand-service/`
5. **Fifth Week**: `services/timing/` enhancements + Kong configuration updates
6. **Sixth Week**: Deployment configurations + comprehensive testing

## **INTEGRATION POINTS WITH EXISTING CODE**

1. **Reuse `src/libternary/`** for ternary operations in timing certification
2. **Integrate with `src/kernel/`** security modes for operation validation
3. **Use `src/tsl/`** for formal verification of payment flows
4. **Leverage `hardware/fpga/timing/`** for femtosecond clock integration
5. **Connect with `src/salvidb/`** for operation state persistence

This implementation adds approximately **45-50 new files** while updating 10-15 existing files, creating a complete payment-to-blockchain witness flow integrated with your existing ternary-torsion architecture.